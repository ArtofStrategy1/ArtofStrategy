<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>S.A.G.E. - AI Strategy Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* --- Base & Animated Background --- */
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(-45deg, #667eea, #764ba2, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradientBG 18s ease infinite;
            color: #f9fafb;
        }
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .page { display: none; } /* Hide all pages by default */
        .page.active { display: block; animation: fadeIn .5s ease-out; } /* Show active page */
        @keyframes fadeIn{from{opacity:0}to{opacity:1}}

        /* --- Glass & Card Effects --- */
        .glass-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 1rem;
            padding: 2.5rem;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }
        .feature-card {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 1rem;
            transition: all .3s ease;
        }
        .feature-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.12);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        .template-card {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 1rem;
            transition: all .3s ease;
            cursor: pointer;
        }
        .template-card:hover {
            transform: translateY(-5px);
            background: rgba(0, 0, 0, 0.3);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        /* --- Buttons --- */
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all .2s;
            text-align: center;
        }
        .btn-primary { background: #4f46e5; color: #fff; }
        .btn-primary:hover { background: #4338ca; }
        .btn-secondary { background: rgba(255,255,255,0.2); color: #fff; }
        .btn-secondary:hover { background: rgba(255,255,255,0.3); }
        .btn-tertiary { background: transparent; color: #c7d2fe; text-decoration: underline; }
        .btn-tertiary:hover { color: #fff; }

        /* --- Forms & Inputs --- */
        .input-field {
            width: 100%;
            padding: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: .5rem;
            font-size: 1rem;
            transition: all .2s;
            background: rgba(255, 255, 255, 0.15);
            color: white;
        }
        .input-field::placeholder { color: rgba(255, 255, 255, 0.6); }
        .input-field:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.2);
            border-color: #a78bfa;
            box-shadow: 0 0 0 3px rgba(167, 139, 250, 0.2);
        }
        .error-message { color: #fca5a5; font-size: .875rem; margin-top: .5rem; background: rgba(220, 38, 38, 0.3); padding: 0.5rem; border-radius: 0.5rem; }
        .success-message { color: #a7f3d0; font-size: .875rem; margin-top: .5rem; background: rgba(5, 150, 105, 0.3); padding: 0.5rem; border-radius: 0.5rem; }

        /* --- Loading Spinners --- */
        .loading-spinner { display: inline-block; width: 16px; height: 16px; border: 2px solid #fff; border-radius: 50%; border-top-color: transparent; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .typing-indicator{display:flex;align-items:center;justify-content:center;gap:8px; padding: 2rem;}
        .typing-dot{width:12px;height:12px;border-radius:50%;background:#a78bfa;animation:typing 1.4s infinite ease-in-out}
        .typing-dot:nth-child(1){animation-delay:-.32s}
        .typing-dot:nth-child(2){animation-delay:-.16s}
        .typing-dot:nth-child(3){animation-delay:0s}
        @keyframes typing{0%,80%,100%{transform:scale(.8);opacity:.5}40%{transform:scale(1);opacity:1}}
    </style>
</head>
<body class="min-h-screen">

    <!-- ========================================================= -->
    <!-- NAVIGATION BAR                                            -->
    <!-- ========================================================= -->
    <nav class="bg-black/10 backdrop-blur-sm p-4 sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <a href="#" class="text-2xl font-bold text-white nav-link" data-page="home">S.A.G.E.</a>
            <div>
                <a href="#" class="text-white/80 hover:text-white px-3 py-2 rounded-md text-sm font-medium nav-link" data-page="home">Home</a>
                <a href="#" class="text-white/80 hover:text-white px-3 py-2 rounded-md text-sm font-medium nav-link" data-page="templates">Templates</a>
                <a href="#" class="text-white/80 hover:text-white px-3 py-2 rounded-md text-sm font-medium nav-link" data-page="login">Login</a>
            </div>
        </div>
    </nav>

    <!-- ========================================================= -->
    <!-- HOME PAGE                                                 -->
    <!-- ========================================================= -->
    <div id="home" class="page active container mx-auto px-6 py-16 text-center">
        <h1 class="text-5xl md:text-6xl font-extrabold text-white leading-tight mb-4">Unlock Your Strategic Potential</h1>
        <p class="text-lg md:text-xl text-white/80 max-w-3xl mx-auto mb-8">
            Transform your organization with comprehensive strategic planning tools and methodologies designed to drive success and innovation.
        </p>
        <div class="flex justify-center space-x-4">
            <button class="btn btn-primary nav-link" data-page="templates">Get Started</button>
            <button class="btn btn-secondary nav-link" data-page="templates">View Analysis</button>
        </div>

        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mt-20 text-left">
            <div class="feature-card p-6">
                <h3 class="text-2xl font-bold mb-2">Vision</h3>
                <p class="text-white/70 mb-4">We help you craft a clear vision with detailed strategic steps that will transform your organization and position you for long-term success in an ever-changing marketplace.</p>
                <a href="#" class="font-semibold text-indigo-300 hover:text-indigo-200 nav-link" data-page="templates">More &rarr;</a>
            </div>
            <div class="feature-card p-6">
                <h3 class="text-2xl font-bold mb-2">Mission or Aim</h3>
                <p class="text-white/70 mb-4">Define your organization's core purpose and establish the foundational principles that will guide all strategic decisions and operational activities.</p>
                <a href="#" class="font-semibold text-indigo-300 hover:text-indigo-200 nav-link" data-page="templates">More &rarr;</a>
            </div>
            <div class="feature-card p-6">
                <h3 class="text-2xl font-bold mb-2">Goals</h3>
                <p class="text-white/70 mb-4">Set ambitious yet achievable goals that align with your vision and mission, creating a clear pathway to success with measurable milestones and timelines.</p>
                <a href="#" class="font-semibold text-indigo-300 hover:text-indigo-200 nav-link" data-page="templates">More &rarr;</a>
            </div>
            <div class="feature-card p-6">
                <h3 class="text-2xl font-bold mb-2">Strategic Initiatives</h3>
                <p class="text-white/70 mb-4">Develop comprehensive strategic initiatives that translate your vision into actionable plans, ensuring effective resource allocation and timeline management.</p>
                <a href="#" class="font-semibold text-indigo-300 hover:text-indigo-200 nav-link" data-page="templates">More &rarr;</a>
            </div>
            <div class="feature-card p-6">
                <h3 class="text-2xl font-bold mb-2">Objectives</h3>
                <p class="text-white/70 mb-4">Break down your goals into specific, measurable objectives that provide clear direction and enable effective progress tracking throughout your organization.</p>
                <a href="#" class="font-semibold text-indigo-300 hover:text-indigo-200 nav-link" data-page="templates">More &rarr;</a>
            </div>
            <div class="feature-card p-6">
                <h3 class="text-2xl font-bold mb-2">Actions</h3>
                <p class="text-white/70 mb-4">Define specific actions and tactics that will drive the achievement of your objectives, with clear accountability and timeline specifications.</p>
                <a href="#" class="font-semibold text-indigo-300 hover:text-indigo-200 nav-link" data-page="templates">More &rarr;</a>
            </div>
        </div>
    </div>

    <!-- ========================================================= -->
    <!-- LOGIN PAGE                                                -->
    <!-- ========================================================= -->
    <div id="login" class="page flex items-center justify-center min-h-[80vh]">
        <div class="w-full max-w-md">
            <div class="glass-container">
                <h2 class="text-3xl font-bold mb-6 text-center text-white">Sign In</h2>
                <div class="space-y-4">
                    <div>
                        <label for="loginEmail" class="block text-sm font-medium text-gray-200 mb-2">Email</label>
                        <input type="email" id="loginEmail" class="input-field" placeholder="Enter your email" required>
                    </div>
                    <div>
                        <label for="loginPassword" class="block text-sm font-medium text-gray-200 mb-2">Password</label>
                        <input type="password" id="loginPassword" class="input-field" placeholder="Enter your password" required>
                    </div>
                    <button id="loginBtn" class="btn btn-primary w-full">
                        <span id="loginBtnText">Sign In</span>
                        <span id="loginSpinner" class="loading-spinner hidden ml-2"></span>
                    </button>
                    <div id="loginMessage" class="hidden"></div>
                </div>
                <div class="text-center mt-6">
                    <p class="text-gray-300">Don't have an account?</p>
                    <button class="btn-tertiary nav-link" data-page="signup">Create Account</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ========================================================= -->
    <!-- SIGNUP PAGE                                               -->
    <!-- ========================================================= -->
    <div id="signup" class="page flex items-center justify-center min-h-[80vh]">
           <div class="w-full max-w-md">
            <div class="glass-container">
                <h2 class="text-3xl font-bold mb-6 text-center text-white">Create Account</h2>
                <div class="space-y-4">
                    <div>
                        <label for="registerName" class="block text-sm font-medium text-gray-200 mb-2">Full Name</label>
                        <input type="text" id="registerName" class="input-field" placeholder="Enter your full name" required>
                    </div>
                    <div>
                        <label for="registerEmail" class="block text-sm font-medium text-gray-200 mb-2">Email</label>
                        <input type="email" id="registerEmail" class="input-field" placeholder="Enter your email" required>
                    </div>
                    <div>
                        <label for="registerPassword" class="block text-sm font-medium text-gray-200 mb-2">Password</label>
                        <input type="password" id="registerPassword" class="input-field" placeholder="Create a password" required>
                    </div>
                    <div>
                        <label for="registerConfirmPassword" class="block text-sm font-medium text-gray-200 mb-2">Confirm Password</label>
                        <input type="password" id="registerConfirmPassword" class="input-field" placeholder="Confirm your password" required>
                    </div>
                    <button id="registerBtn" class="btn btn-primary w-full">
                        <span id="registerBtnText">Create Account</span>
                        <span id="registerSpinner" class="loading-spinner hidden ml-2"></span>
                    </button>
                    <div id="registerMessage" class="hidden"></div>
                </div>
                <div class="text-center mt-6">
                    <p class="text-gray-300">Already have an account?</p>
                    <button class="btn-tertiary nav-link" data-page="login">Sign In</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ========================================================= -->
    <!-- TEMPLATES LIST PAGE                                       -->
    <!-- ========================================================= -->
    <div id="templates" class="page container mx-auto px-6 py-16">
        <h1 class="text-4xl font-bold text-center mb-2">Strategy Templates</h1>
        <p class="text-lg text-white/80 text-center mb-12 max-w-2xl mx-auto">Select a professional analysis template to begin. Our AI will guide you through a structured framework to generate powerful strategic insights.</p>
        <div id="templatesList" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Template cards will be dynamically inserted here by JavaScript -->
        </div>
    </div>

    <!-- ========================================================= -->
    <!-- TEMPLATE DETAIL PAGE                                      -->
    <!-- ========================================================= -->
    <div id="templateDetail" class="page container mx-auto px-6 py-16">
        <button class="btn btn-secondary mb-8 nav-link" data-page="templates">&larr; Back to Templates</button>
        <div class="grid lg:grid-cols-2 gap-12">
            <!-- Left side: Form -->
            <div>
                <h1 id="templateTitle" class="text-4xl font-bold mb-4">Template Title</h1>
                <p id="templateDescription" class="text-white/80 mb-8">Template description goes here.</p>
                <div class="glass-container p-6">
                    <div class="space-y-4">
                        <div>
                            <label for="companyName" class="block text-sm font-medium text-gray-200 mb-2">Company Name</label>
                            <input type="text" id="companyName" class="input-field" placeholder="e.g., Innovate Inc." required>
                        </div>
                        <div>
                            <label for="useCase" class="block text-sm font-medium text-gray-200 mb-2">Use Case</label>
                            <input type="text" id="useCase" class="input-field" placeholder="e.g., Q4 Marketing Strategy" required>
                        </div>
                        <div>
                            <label for="location" class="block text-sm font-medium text-gray-200 mb-2">Location</label>
                            <input type="text" id="location" class="input-field" placeholder="e.g., Global" required>
                        </div>
                        <button id="generateBtn" class="btn btn-primary w-full">
                            <span id="generateBtnText">Generate Analysis</span>
                            <span id="generateSpinner" class="loading-spinner hidden ml-2"></span>
                        </button>
                    </div>
                </div>
            </div>
            <!-- Right side: Result -->
            <div>
                <h2 class="text-3xl font-bold mb-4">Generated Analysis</h2>
                <div id="analysisResult" class="glass-container min-h-[300px] whitespace-pre-wrap overflow-x-auto">
                    <div class="text-white/60 p-8 text-center">Your generated analysis will appear here.</div>
                </div>
            </div>
        </div>
    </div>


<script>
// =========================================================
// SCRIPT
// =========================================================
document.addEventListener('DOMContentLoaded', () => {

    // --- DOM Element References ---
    const $ = id => document.getElementById(id);
    const pages = document.querySelectorAll('.page');
    const navLinks = document.querySelectorAll('.nav-link');
    const templatesListContainer = $('templatesList');
    const templateDetailContainer = $('templateDetail');
    let currentTemplateId = null; // To store the ID of the selected template

    // --- User Session State (NEW) ---
    let userLoggedIn = false; // This will track if a user is logged in

    // --- Template Data ---
    const templates = {
        'swot': {
            title: 'SWOT Analysis',
            description: "Analyze your organization's Strengths, Weaknesses, Opportunities, and Threats with a comprehensive framework.",
            prompt: `Please conduct a comprehensive SWOT analysis for my organization. I need you to help me identify and analyze:

STRENGTHS (Internal Positive Factors):
- What advantages do we have over competitors?
- What do we do well?
- What unique resources or assets do we have?
- What do others see as our strengths?

WEAKNESSES (Internal Negative Factors):
- What areas need improvement?
- Where do we lack resources?
- What do competitors do better?
- What internal factors limit our performance?

OPPORTUNITIES (External Positive Factors):
- What market trends could benefit us?
- What changes in technology, regulations, or society could we leverage?
- What gaps exist in the market?
- What partnerships or alliances could benefit us?

THREATS (External Negative Factors):
- What obstacles do we face?
- What competitive threats exist?
- What external changes could harm us?
- What regulatory or economic challenges loom?

Please provide a structured analysis with actionable insights and strategic recommendations based on the SWOT matrix.`
        },
        'competitor': {
            title: 'Competitor Analysis',
            description: 'Deep dive into competitor strategies, market positioning, and competitive advantages to inform your strategy.',
            prompt: `I need a comprehensive competitor analysis. Please help me analyze my competitive landscape using this framework:

COMPETITOR IDENTIFICATION:
- Who are our direct competitors?
- Who are our indirect competitors?
- Who are potential future competitors?

COMPETITIVE ANALYSIS FRAMEWORK:
1. Market Position & Share
2. Products/Services Comparison
3. Pricing Strategies
4. Marketing & Brand Positioning
5. Strengths & Weaknesses
6. Financial Performance (if available)
7. Strategic Direction & Future Plans

COMPETITIVE INTELLIGENCE:
- What are competitors doing well that we should learn from?
- Where are their vulnerabilities?
- What opportunities exist due to competitor gaps?
- How do customers perceive competitors vs. our brand?`
        },
        'market-entry': {
            title: 'Market Entry Strategy',
            description: 'Evaluate market opportunities, entry barriers, and develop a roadmap for successful market penetration.',
            prompt: `I need help developing a market entry strategy. Please guide me through a comprehensive analysis covering:

MARKET ASSESSMENT:
- Market size and growth potential
- Customer segments and needs analysis
- Market maturity and lifecycle stage
- Regulatory environment and requirements

COMPETITIVE LANDSCAPE:
- Key players and their market positions
- Competitive advantages and barriers
- Pricing strategies and profit margins
- Distribution channels and partnerships

ENTRY STRATEGY OPTIONS:
1. Direct export/online sales
2. Licensing or franchising
3. Joint ventures or partnerships
4. Acquisitions or mergers
5. Greenfield investment (new operations)`
        },
        'financial': {
            title: 'Financial Projections',
            description: 'Create comprehensive financial forecasts, budgets, and scenario planning for strategic decision-making.',
            prompt: `I need help creating comprehensive financial projections and analysis. Please assist with:

REVENUE PROJECTIONS:
- Sales forecasting methodologies
- Market size and penetration assumptions
- Pricing strategy analysis

COST STRUCTURE ANALYSIS:
- Fixed vs. variable cost breakdown
- Cost of goods sold (COGS) analysis
- Operating expense projections

PROFITABILITY ANALYSIS:
- Gross margin analysis
- Operating margin projections
- Net profit forecasting
- Break-even analysis`
        },
        'risk': {
            title: 'Risk Assessment',
            description: 'Identify, evaluate, and develop mitigation strategies for business risks across all operational areas.',
            prompt: `I need a comprehensive risk assessment and management strategy. Please help me analyze and address:

RISK IDENTIFICATION:
- Strategic Risks (Market, competitive, technology)
- Operational Risks (Supply chain, process failures, human resource)
- Financial Risks (Credit, liquidity, market)
- External Risks (Economic, political, cybersecurity)

RISK ASSESSMENT MATRIX:
- For each risk: Probability, Impact, Priority

RISK MITIGATION STRATEGIES:
- Avoidance, Reduction, Transfer, Acceptance`
        },
        'business-model': {
            title: 'Business Model Canvas',
            description: 'Design and analyze your business model using the proven 9-building-block framework for strategic clarity.',
            prompt: `Let's design and analyze your business model using the Business Model Canvas framework. I'll guide you through each of the 9 building blocks:
1. Customer Segments
2. Value Propositions
3. Channels
4. Customer Relationships
5. Revenue Streams
6. Key Resources
7. Key Activities
8. Key Partnerships
9. Cost Structure`
        },
        // --- New Templates ---
        'marketing-plan': {
            title: 'Marketing Plan Development',
            description: 'Craft a detailed marketing strategy, including target audience, channels, and campaign planning.',
            prompt: `Develop a comprehensive marketing plan for my organization. Please include the following sections:

1.  **Executive Summary:** Brief overview of the plan.
2.  **Situational Analysis:**
    * Market Analysis (size, trends, growth)
    * Target Audience (demographics, psychographics, needs)
    * Competitor Analysis (key players, strategies)
    * SWOT Analysis (Strengths, Weaknesses, Opportunities, Threats)
3.  **Marketing Objectives:** SMART (Specific, Measurable, Achievable, Relevant, Time-bound) objectives.
4.  **Marketing Strategy:**
    * Product/Service Strategy
    * Pricing Strategy
    * Distribution Strategy (Place)
    * Promotion Strategy (Communication channels, messaging)
5.  **Action Plan:** Specific tactics, timelines, and responsibilities.
6.  **Budget:** Allocation of resources.
7.  **Measurement & Evaluation:** KPIs and methods for tracking success.`
        },
        'product-launch': {
            title: 'Product Launch Strategy',
            description: 'Plan a successful product launch from pre-launch to post-launch activities and market adoption.',
            prompt: `Outline a detailed product launch strategy for a new product/service. Cover the following phases:

1.  **Pre-Launch Phase:**
    * Market Research & Validation
    * Product Development & Testing
    * Pricing & Packaging Strategy
    * Distribution Channel Selection
    * Marketing & Communication Plan (messaging, branding)
    * Sales Team Training
    * Customer Support Readiness
2.  **Launch Phase:**
    * Launch Event/Announcement
    * Initial Marketing Campaigns
    * Sales Activities
    * PR & Media Relations
3.  **Post-Launch Phase:**
    * Performance Monitoring (sales, adoption, feedback)
    * Customer Feedback Collection & Iteration
    * Scalability Planning
    * Ongoing Marketing & Sales Support
    * Contingency Planning`
        },
        'customer-segmentation': {
            title: 'Customer Segmentation Analysis',
            description: 'Identify and analyze distinct customer groups to tailor marketing and product development efforts.',
            prompt: `Perform a customer segmentation analysis for my business. Identify key segments and provide insights on how to target them effectively. Consider the following criteria:

1.  **Demographic Segmentation:** (Age, gender, income, education, occupation, family status)
2.  **Geographic Segmentation:** (Location, climate, urban/rural)
3.  **Psychographic Segmentation:** (Lifestyle, values, attitudes, interests, personality traits)
4.  **Behavioral Segmentation:** (Purchase history, usage rate, brand loyalty, benefits sought, readiness to buy)

For each identified segment, provide:
-   A clear profile.
-   Their unique needs and pain points.
-   Recommended value propositions.
-   Preferred communication channels.
-   Potential product/service adaptations.`
        },
        'supply-chain-opt': {
            title: 'Supply Chain Optimization',
            description: 'Identify inefficiencies and opportunities to streamline your supply chain for cost savings and improved delivery.',
            prompt: `Conduct an analysis for supply chain optimization. Focus on identifying areas for improvement in efficiency, cost-effectiveness, and resilience. Address the following:

1.  **Current State Assessment:**
    * Mapping of the existing supply chain (suppliers, production, distribution, customers).
    * Identification of key processes and bottlenecks.
    * Analysis of current costs (procurement, production, logistics, inventory).
2.  **Key Challenges & Opportunities:**
    * Areas of inefficiency (e.g., excess inventory, long lead times, transportation costs).
    * Vulnerabilities (e.g., single-source suppliers, geopolitical risks).
    * Opportunities for technology adoption (e.g., automation, AI, blockchain).
3.  **Optimization Strategies:**
    * Inventory Management (e.g., JIT, safety stock optimization).
    * Logistics & Transportation (e.g., route optimization, carrier selection).
    * Supplier Relationship Management.
    * Demand Forecasting Improvement.
    * Sustainability Initiatives.
4.  **Implementation Roadmap:** Prioritized actions and expected outcomes.`
        },
        'hr-strategy': {
            title: 'Human Resources Strategy',
            description: 'Develop an HR strategy aligned with business goals, covering talent acquisition, development, and retention.',
            prompt: `Create a strategic human resources plan aligned with overall business objectives. Address the following core components:

1.  **Workforce Planning:**
    * Current workforce analysis (skills, demographics).
    * Future workforce needs (talent gaps, growth projections).
    * Succession planning.
2.  **Talent Acquisition Strategy:**
    * Recruitment channels and employer branding.
    * Candidate experience.
    * Onboarding process.
3.  **Talent Development & Training:**
    * Learning and development programs.
    * Performance management systems.
    * Career pathing.
4.  **Compensation & Benefits:**
    * Competitive pay structures.
    * Employee benefits and wellness programs.
5.  **Employee Engagement & Retention:**
    * Culture and values.
    * Recognition programs.
    * Employee well-being initiatives.
6.  **HR Technology & Analytics:** Leveraging HRIS and data for decision-making.`
        },
        'digital-transformation': {
            title: 'Digital Transformation Roadmap',
            description: 'Plan your organization\'s journey towards digital maturity, integrating technology across all business functions.',
            prompt: `Develop a digital transformation roadmap for my organization. This roadmap should outline key areas for digital adoption and a phased implementation plan. Include:

1.  **Vision & Objectives:** What does digital transformation mean for us, and what are our key goals?
2.  **Current State Assessment:**
    * Analysis of existing digital capabilities and infrastructure.
    * Identification of pain points and legacy systems.
    * Assessment of digital maturity across departments.
3.  **Key Pillars of Transformation:** (e.g., Customer Experience, Operational Efficiency, New Business Models, Data & Analytics, Culture & Talent)
4.  **Initiatives & Technologies:**
    * Specific digital projects (e.g., CRM implementation, cloud migration, AI integration, automation).
    * Required technologies and platforms.
5.  **Phased Implementation Plan:**
    * Short-term (0-6 months): Quick wins, foundational changes.
    * Mid-term (6-18 months): Core system integrations, process automation.
    * Long-term (18+ months): Advanced analytics, AI-driven insights, new digital services.
6.  **Change Management & Culture:** Strategies for fostering a digital-first mindset.
7.  **Measurement & KPIs:** How will we track the success of our digital transformation?`
        }
    };

    // --- Navigation Logic ---
    function navigateTo(pageId) {
        // Logic for restricted pages
        if (pageId === 'templates' && !userLoggedIn) {
            showMessage('loginMessage', 'Please log in to access templates.', 'error');
            navigateTo('login'); // Redirect to login
            return;
        }

        if ((pageId === 'login' || pageId === 'signup') && userLoggedIn) {
            // If already logged in, prevent navigation to login/signup
            showMessage('loginMessage', 'You are already logged in.', 'success');
            navigateTo('templates'); // Redirect to templates or home
            return;
        }

        pages.forEach(page => {
            page.classList.remove('active');
            // Explicitly hide login/signup pages if user is logged in
            if ((page.id === 'login' || page.id === 'signup') && userLoggedIn) {
                page.style.display = 'none'; // Ensure they are hidden
            } else {
                page.style.display = 'none'; // Hide all pages by default
            }
        });

        const targetPage = $(pageId);
        if (targetPage) {
            targetPage.classList.add('active');
            targetPage.style.display = 'block'; // Ensure active page is visible
            window.scrollTo(0, 0);
        }
    }

    // --- Update Navigation Bar Links (NEW) ---
    function updateNavBar() {
        const loginLink = document.querySelector('a[data-page="login"], a[data-page="logout"]'); // Select both
        const templatesLink = document.querySelector('a[data-page="templates"]');

        if (userLoggedIn) {
            if (loginLink) {
                loginLink.textContent = 'Logout';
                loginLink.setAttribute('data-page', 'logout');
            }
            if (templatesLink) {
                templatesLink.classList.remove('hidden'); // Show templates link
            }
        } else {
            if (loginLink) {
                loginLink.textContent = 'Login';
                loginLink.setAttribute('data-page', 'login');
            }
            if (templatesLink) {
                templatesLink.classList.add('hidden'); // Hide templates link
            }
        }
        attachNavLinkListeners(); // Re-attach listeners as data-page attributes might change
    }

    // --- Attach Navigation Link Listeners (Refactored) ---
    function attachNavLinkListeners() {
        navLinks.forEach(link => {
            link.removeEventListener('click', handleNavLinkClick); // Remove old listeners to prevent duplicates
            link.addEventListener('click', handleNavLinkClick); // Add new listeners
        });
    }

    function handleNavLinkClick(e) {
        e.preventDefault();
        const pageId = this.getAttribute('data-page');

        if (pageId === 'logout') {
            handleLogout();
            return;
        }

        if (pageId === 'templates' && !userLoggedIn) {
            showMessage('loginMessage', 'Please log in to access templates.', 'error'); // Display message on login page
            navigateTo('login');
            return;
        }

        if ((pageId === 'login' || pageId === 'signup') && userLoggedIn) {
            showMessage('loginMessage', 'You are already logged in.', 'success'); // Display message on login page
            navigateTo('home'); // Or navigate to templates
            return;
        }
        navigateTo(pageId);
    }

    // --- Template Page Logic ---
    function populateTemplatesList() {
        templatesListContainer.innerHTML = '';
        for (const id in templates) {
            const template = templates[id];
            const card = document.createElement('div');
            card.className = 'template-card p-6';
            card.setAttribute('data-template-id', id);
            card.innerHTML = `
                <h3 class="text-2xl font-bold mb-2">${template.title}</h3>
                <p class="text-white/70">${template.description}</p>
            `;
            card.addEventListener('click', () => {
                if (userLoggedIn) {
                    showTemplateDetail(id);
                } else {
                    showMessage('loginMessage', 'Please log in to use templates.', 'error');
                    navigateTo('login');
                }
            });
            templatesListContainer.appendChild(card);
        }
    }

    function showTemplateDetail(templateId) {
        currentTemplateId = templateId;
        const template = templates[templateId];
        if (!template) return;

        $('templateTitle').textContent = template.title;
        $('templateDescription').textContent = template.description;

        // Clear previous results and inputs
        $('companyName').value = '';
        $('useCase').value = '';
        $('location').value = '';
        $('analysisResult').innerHTML = '<div class="text-white/60 p-8 text-center">Your generated analysis will appear here.</div>';

        navigateTo('templateDetail');
    }

    // --- Analysis Generation ---
    async function handleGenerate() {
        if (!currentTemplateId) return;

        const companyName = $('companyName').value.trim();
        const useCase = $('useCase').value.trim();
        const location = $('location').value.trim();
        const analysisResultContainer = $('analysisResult');

        if (!companyName || !useCase || !location) {
            analysisResultContainer.innerHTML = `<div class="p-4 text-center text-red-400">Please fill out all fields before generating.</div>`;
            return;
        }

        const basePrompt = templates[currentTemplateId].prompt;
        const fullPrompt = `
User Information:
- Company Name: ${companyName}
- Use Case: ${useCase}
- Location: ${location}

---

Template Prompt:
${basePrompt}`;

        setLoading('generate', true);
        analysisResultContainer.innerHTML = `
            <div class="typing-indicator">
                <div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div>
            </div>
            <p class="text-center text-white/70 pb-8">Generating your analysis, please wait...</p>
        `;

        try {
            // Corrected N8N webhook for analysis
            const response = await fetch('https://n8n.data2int.com/webhook-test/analysis', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify([{
                    customerName: companyName,
                    location: location,
                    useCase: useCase,
                    prompt: fullPrompt
                }])
            });

            let resultText;
            const contentType = response.headers.get('content-type') || '';
            if (contentType.includes('application/json')) {
                const jsonResponse = await response.json();
                resultText = JSON.stringify(jsonResponse, null, 2);
            } else {
                resultText = await response.text();
            }
            analysisResultContainer.textContent = resultText;

        } catch (error) {
            analysisResultContainer.textContent = `An error occurred: ${error.message}`;
            console.error("Fetch error:", error);
        } finally {
            setLoading('generate', false);
        }
    }

    $('generateBtn').addEventListener('click', handleGenerate);

    // --- Auth Logic (Now using n8n webhooks for actual calls) ---
    async function handleLogin() {
        const email = $('loginEmail').value.trim();
        const password = $('loginPassword').value;
        const loginMessageEl = $('loginMessage');

        if (!email || !password) {
            showMessage('loginMessage', 'Please fill in all fields', 'error');
            return;
        }

        setLoading('login', true);
        loginMessageEl.classList.add('hidden'); // Hide previous messages

        try {
            // Corrected N8N webhook for login
            const response = await fetch('https://n8n.data2int.com/webhook-test/Login1', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, password })
            });

            const result = await response.json();

            if (response.ok) {
                userLoggedIn = true;
                showMessage('loginMessage', 'Login successful! Redirecting to templates...', 'success');
                updateNavBar(); // Update nav bar after successful login
                setTimeout(() => navigateTo('templates'), 1500); // Redirect to templates page
            } else {
                showMessage('loginMessage', result.message || 'Login failed. Please check your credentials.', 'error');
            }
        } catch (error) {
            showMessage('loginMessage', 'An error occurred during login. Please try again.', 'error');
            console.error("Login error:", error);
        } finally {
            setLoading('login', false);
        }
    }

    async function handleRegister() {
        const name = $('registerName').value.trim();
        const email = $('registerEmail').value.trim();
        const password = $('registerPassword').value;
        const confirmPassword = $('registerConfirmPassword').value;
        const registerMessageEl = $('registerMessage');

        if (!name || !email || !password || !confirmPassword) {
            showMessage('registerMessage', 'Please fill in all fields', 'error');
            return;
        }
        if (password !== confirmPassword) {
            showMessage('registerMessage', 'Passwords do not match', 'error');
            return;
        }

        setLoading('register', true);
        registerMessageEl.classList.add('hidden'); // Hide previous messages

        try {
            // Corrected N8N webhook for registration
            const response = await fetch('https://n8n.data2int.com/webhook-test/Create1', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name, email, password })
            });

            const result = await response.json();

            if (response.ok) {
                showMessage('registerMessage', 'Account created successfully! Please log in.', 'success');
                setTimeout(() => navigateTo('login'), 1500);
            } else {
                showMessage('registerMessage', result.message || 'Registration failed. Please try again.', 'error');
            }
        } catch (error) {
            showMessage('registerMessage', 'An error occurred during registration. Please try again.', 'error');
            console.error("Register error:", error);
        } finally {
            setLoading('register', false);
        }
    }

    function handleLogout() {
        userLoggedIn = false;
        updateNavBar();
        showMessage('loginMessage', 'You have been logged out.', 'success'); // Display message on login page
        navigateTo('login'); // Redirect to login page after logout
    }

    $('loginBtn').addEventListener('click', handleLogin);
    $('registerBtn').addEventListener('click', handleRegister);

    function setLoading(type, isLoading) {
        const btn = $(`${type}Btn`);
        const text = $(`${type}BtnText`);
        const spinner = $(`${type}Spinner`);
        if (btn) {
            btn.disabled = isLoading;
            if (text) text.textContent = isLoading ? 'Processing...' : (type === 'login' ? 'Sign In' : (type === 'register' ? 'Create Account' : 'Generate Analysis'));
            if (spinner) spinner.classList.toggle('hidden', !isLoading);
        }
    }

    function showMessage(id, msg, type) {
        const el = $(id);
        el.textContent = msg;
        el.className = type === 'error' ? 'error-message' : 'success-message';
        el.classList.remove('hidden');
        setTimeout(() => el.classList.add('hidden'), 3000);
    }

    // --- Initial Setup ---
    populateTemplatesList();
    updateNavBar(); // Initialize nav bar state (hides templates link)
    navigateTo('home'); // Start on the home page
});
</script>
</body>
</html>
